<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Memory Match Game</title>

    <style>
        body {
            margin: 0;
            background: #000814;
            font-family: "Poppins", sans-serif;
            color: #b8e2ff;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1 {
            margin-top: 20px;
            color: #90e0ef;
        }

        #topPanel {
            margin-top: 20px;
            display: flex;
            gap: 25px;
            font-size: 18px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .panelBox {
            background: #001d3d;
            padding: 10px 20px;
            border-radius: 10px;
            border: 1px solid #00b4d8;
            text-align: center;
        }

        #controls {
            margin-top: 20px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        button {
            padding: 10px 20px;
            border-radius: 10px;
            border: none;
            cursor: pointer;
            background: linear-gradient(45deg, #7209b7, #4361ee);
            color: #fff;
            font-size: 16px;
        }

        /* -------- RESPONSIVE GRID FIX -------- */
        #board {
            margin-top: 35px;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            /* Always 4 columns */
            gap: 15px;
            width: 90%;
            max-width: 500px;
        }

        .card {
            width: 100%;
            aspect-ratio: 1;
            /* Perfect square */
            border-radius: 12px;
            background: #003566;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: clamp(24px, 6vw, 45px);
            color: #fff;
            border: 2px solid #00eaff;
            box-shadow: 0 0 10px #00eaff;
            cursor: pointer;
            transition: 0.3s;
        }

        .card.flipped {
            background: #caf0f8;
            color: #000;
        }

        .card.matched {
            background: #80ffdb;
            color: #000;
            box-shadow: 0 0 15px #80ffdb;
            cursor: default;
        }

        /* ------- MODALS ------- */
        #resultModal,
        #instructionModal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.75);
            display: none;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s;
        }

        .modalBox {
            background: #001d3d;
            padding: 30px;
            width: 350px;
            border-radius: 14px;
            border: 2px solid #00b4d8;
            box-shadow: 0 0 20px #00b4d8;
            text-align: center;
            animation: scaleIn 0.3s;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes scaleIn {
            from {
                transform: scale(0.7);
            }

            to {
                transform: scale(1);
            }
        }

        /* Confetti */
        .confetti {
            position: fixed;
            top: -10px;
            width: 10px;
            height: 10px;
            opacity: 0.8;
            animation: fall linear infinite;
        }

        @keyframes fall {
            to {
                transform: translateY(100vh) rotate(360deg);
            }
        }
    </style>
</head>

<body>

    <h1>Memory Match</h1>

    <div id="topPanel">
        <div class="panelBox">‚è± Time: <span id="time">00:00</span></div>
        <div class="panelBox">üîÅ Moves: <span id="moves">0</span></div>
        <div class="panelBox">üéØ Matches: <span id="matches">0</span></div>
    </div>

    <div id="controls">
        <button onclick="restartGame()">üîÑ Restart</button>
        <button onclick="openInstruction()">üìò How to Play</button>
    </div>

    <div id="board"></div>

    <!-- WIN MODAL -->
    <div id="resultModal">
        <div class="modalBox">
            <h2>üéâ Mission Complete!</h2>
            <p>‚è± Time: <span id="finalTime"></span></p>
            <p>üîÅ Moves: <span id="finalMoves"></span></p>
            <button onclick="restartGame()">Play Again</button>
        </div>
    </div>

    <!-- INSTRUCTION MODAL -->
    <div id="instructionModal">
        <div class="modalBox">
            <h2>üìò How to Play</h2>
            <p>‚Ä¢ Flip two cards each turn.</p>
            <p>‚Ä¢ If both emojis match ‚Üí you score a pair.</p>
            <p>‚Ä¢ Match all pairs to win the game.</p>
            <p>‚Ä¢ Try to finish in fewer moves and less time!</p>
            <button onclick="closeInstruction()">Close</button>
        </div>
    </div>

    <!-- üîä SOUNDS -->
    <audio id="clickSound" src="./click.mp3"></audio>
    <audio id="matchSound" src="./match.mp3"></audio>
    <audio id="winSound" src="./win.mp3"></audio>

    <script>
        const clickS = document.getElementById("clickSound");
        const matchS = document.getElementById("matchSound");
        const winS = document.getElementById("winSound");

        function playClick() { clickS.currentTime = 0; clickS.play().catch(() => { }); }
        function playMatch() { matchS.currentTime = 0; matchS.play().catch(() => { }); }
        function playWin() { winS.currentTime = 0; winS.play().catch(() => { }); }

        const symbols = ["üê∂", "üê±", "üêº", "ü¶Å", "üêØ", "üê∏", "üêµ", "ü¶ä"];
        let deck = [], flipped = [], matched = 0, moves = 0;
        let timer = null, seconds = 0;

        const board = document.getElementById("board");
        const movesEl = document.getElementById("moves");
        const matchesEl = document.getElementById("matches");
        const timeEl = document.getElementById("time");

        function startTimer() {
            timer = setInterval(() => {
                seconds++;
                const m = String(Math.floor(seconds / 60)).padStart(2, "0");
                const s = String(seconds % 60).padStart(2, "0");
                timeEl.textContent = `${m}:${s}`;
            }, 1000);
        }

        function shuffle(arr) {
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        function createDeck() {
            deck = [];
            let list = shuffle(symbols.concat(symbols));
            list.forEach((sym, i) => deck.push({ id: i, symbol: sym, matched: false }));
        }

        function renderBoard() {
            board.innerHTML = "";
            deck.forEach(card => {
                const div = document.createElement("div");
                div.classList.add("card");
                div.setAttribute("data-id", card.id);
                div.textContent = "?";
                div.onclick = () => flip(card.id);
                board.appendChild(div);
            });
        }

        function flip(id) {
            playClick();

            const card = deck[id];
            const el = document.querySelector(`.card[data-id="${id}"]`);

            if (card.matched || flipped.includes(id)) return;
            if (flipped.length === 2) return;

            if (seconds === 0 && moves === 0) startTimer();

            el.classList.add("flipped");
            el.textContent = card.symbol;
            flipped.push(id);

            if (flipped.length === 2) {
                moves++;
                movesEl.textContent = moves;
                setTimeout(checkMatch, 500);
            }
        }

        function checkMatch() {
            const [a, b] = flipped;
            const c1 = deck[a], c2 = deck[b];
            const el1 = document.querySelector(`.card[data-id="${a}"]`);
            const el2 = document.querySelector(`.card[data-id="${b}"]`);

            if (c1.symbol === c2.symbol) {
                c1.matched = c2.matched = true;
                matched++;
                matchesEl.textContent = matched;

                el1.classList.add("matched");
                el2.classList.add("matched");
                playMatch();

                if (matched === symbols.length) gameWon();
            } else {
                el1.classList.remove("flipped"); el1.textContent = "?";
                el2.classList.remove("flipped"); el2.textContent = "?";
            }

            flipped = [];
        }

        function gameWon() {
            clearInterval(timer);
            playWin();
            celebrate();
            document.getElementById("finalTime").textContent = timeEl.textContent;
            document.getElementById("finalMoves").textContent = moves;
            document.getElementById("resultModal").style.display = "flex";
        }

        function restartGame() {
            clearInterval(timer);
            seconds = 0;
            timeEl.textContent = "00:00";
            moves = matched = 0;
            movesEl.textContent = 0;
            matchesEl.textContent = 0;
            flipped = [];
            document.getElementById("resultModal").style.display = "none";
            createDeck();
            renderBoard();
        }

        function celebrate() {
            for (let i = 0; i < 100; i++) {
                const c = document.createElement("div");
                c.classList.add("confetti");
                c.style.left = Math.random() * 100 + "%";
                c.style.background = `hsl(${Math.random() * 360}, 100%, 70%)`;
                c.style.animationDuration = 2 + Math.random() * 3 + "s";
                document.body.appendChild(c);
                setTimeout(() => c.remove(), 5000);
            }
        }

        function openInstruction() {
            document.getElementById("instructionModal").style.display = "flex";
        }
        function closeInstruction() {
            document.getElementById("instructionModal").style.display = "none";
        }

        restartGame();
    </script>

</body>

</html>